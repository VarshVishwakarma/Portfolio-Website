{% extends "base.html" %}

{% block content %}
<section class="min-h-screen pt-24 px-6 max-w-4xl mx-auto flex flex-col items-center">
    <div class="text-center mb-10">
        <h1 class="text-4xl font-cyber font-bold mb-2">Model <span class="text-neonRed">Playground</span></h1>
        <p class="text-gray-400">Interact with live inference API endpoints.</p>
    </div>

    <div class="w-full glass rounded-lg border border-gray-800 shadow-2xl overflow-hidden">
        <div class="bg-gray-900 px-4 py-2 flex items-center gap-2 border-b border-gray-800">
            <div class="w-3 h-3 rounded-full bg-red-500"></div>
            <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
            <div class="w-3 h-3 rounded-full bg-green-500"></div>
            <span class="ml-2 text-xs text-gray-500 font-mono">root@ml-portfolio:~/inference</span>
        </div>
        
        <div class="p-6 font-mono text-sm">
            <div class="mb-4 text-green-400">
                $ init_model --type=sentiment_analysis --load_weights=true<br>
                > Model loaded successfully (0.2s)<br>
                > Waiting for input...
            </div>

            <div class="flex gap-2 items-center mb-6">
                <span class="text-neonBlue">INPUT >></span>
                <input type="text" id="aiInput" class="flex-1 bg-transparent border-b border-gray-700 focus:border-neonBlue text-white outline-none py-1" placeholder="Type a sentence to analyze...">
                <button onclick="runAI()" class="px-4 py-1 bg-gray-800 hover:bg-neonBlue hover:text-black text-white text-xs border border-gray-600 transition">EXECUTE</button>
            </div>

            <div id="aiOutput" class="hidden border-l-2 border-neonRed pl-4 py-2 bg-black/30 rounded">
                <p class="text-gray-400 text-xs mb-1">// JSON Response</p>
                <pre class="text-neonRed" id="jsonResult"></pre>
            </div>
        </div>
    </div>
</section>

<script>
    async function runAI() {
        const input = document.getElementById('aiInput').value;
        const outputDiv = document.getElementById('aiOutput');
        const resultPre = document.getElementById('jsonResult');

        if(!input) return;

        resultPre.innerText = "Processing...";
        outputDiv.classList.remove('hidden');

        try {
            const response = await fetch('/api/analyze', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ text: input })
            });
            const data = await response.json();
            
            // Typewriter effect for result
            resultPre.innerHTML = JSON.stringify(data, null, 2).replace(/"/g, '');
        } catch (error) {
            resultPre.innerText = "Error: Connection Failed.";
        }
    }
</script>
{% endblock %}